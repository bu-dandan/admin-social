{"remainingRequest":"/Users/mac/code/2023/vue0508_副本/node_modules/babel-loader/lib/index.js!/Users/mac/code/2023/vue0508_副本/src/permission.js","dependencies":[{"path":"/Users/mac/code/2023/vue0508_副本/src/permission.js","mtime":1683594990689},{"path":"/Users/mac/code/2023/vue0508_副本/babel.config.js","mtime":1681876381588},{"path":"/Users/mac/code/2023/vue0508_副本/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mac/code/2023/vue0508_副本/node_modules/babel-loader/lib/index.js","mtime":456789000000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiL1VzZXJzL21hYy9jb2RlLzIwMjMvdnVlMDUwOF9cdTUyNkZcdTY3MkMvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3JlZ2VuZXJhdG9yUnVudGltZS5qcyI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICIvVXNlcnMvbWFjL2NvZGUvMjAyMy92dWUwNTA4X1x1NTI2Rlx1NjcyQy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUuanMiOwppbXBvcnQgcm91dGVyIGZyb20gJy4vcm91dGVyJzsKaW1wb3J0IHN0b3JlIGZyb20gJy4vc3RvcmUnOwppbXBvcnQgeyBNZXNzYWdlIH0gZnJvbSAnZWxlbWVudC11aSc7CmltcG9ydCBOUHJvZ3Jlc3MgZnJvbSAnbnByb2dyZXNzJzsgLy8gcHJvZ3Jlc3MgYmFyCmltcG9ydCAnbnByb2dyZXNzL25wcm9ncmVzcy5jc3MnOyAvLyBwcm9ncmVzcyBiYXIgc3R5bGUKaW1wb3J0IHsgZ2V0VG9rZW4gfSBmcm9tICdAL3V0aWxzL2F1dGgnOyAvLyBnZXQgdG9rZW4gZnJvbSBjb29raWUKaW1wb3J0IGdldFBhZ2VUaXRsZSBmcm9tICdAL3V0aWxzL2dldC1wYWdlLXRpdGxlJzsKTlByb2dyZXNzLmNvbmZpZ3VyZSh7CiAgc2hvd1NwaW5uZXI6IGZhbHNlCn0pOyAvLyBOUHJvZ3Jlc3MgQ29uZmlndXJhdGlvbgoKdmFyIHdoaXRlTGlzdCA9IFsnL2xvZ2luJ107IC8vIG5vIHJlZGlyZWN0IHdoaXRlbGlzdAoKcm91dGVyLmJlZm9yZUVhY2goIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgdmFyIF9yZWYgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL19yZWdlbmVyYXRvclJ1bnRpbWUoKS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUodG8sIGZyb20sIG5leHQpIHsKICAgIHZhciBoYXNUb2tlbiwgaGFzR2V0VXNlckluZm87CiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICAvLyBzdGFydCBwcm9ncmVzcyBiYXIKICAgICAgICAgIE5Qcm9ncmVzcy5zdGFydCgpOwoKICAgICAgICAgIC8vIHNldCBwYWdlIHRpdGxlCiAgICAgICAgICBkb2N1bWVudC50aXRsZSA9IGdldFBhZ2VUaXRsZSh0by5tZXRhLnRpdGxlKTsKCiAgICAgICAgICAvLyBkZXRlcm1pbmUgd2hldGhlciB0aGUgdXNlciBoYXMgbG9nZ2VkIGluCiAgICAgICAgICBoYXNUb2tlbiA9IGdldFRva2VuKCk7CiAgICAgICAgICBpZiAoIWhhc1Rva2VuKSB7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzMDsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoISh0by5wYXRoID09PSAnL2xvZ2luJykpIHsKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgICAgLy8gaWYgaXMgbG9nZ2VkIGluLCByZWRpcmVjdCB0byB0aGUgaG9tZSBwYWdlCiAgICAgICAgICBuZXh0KHsKICAgICAgICAgICAgcGF0aDogJy8nCiAgICAgICAgICB9KTsKICAgICAgICAgIE5Qcm9ncmVzcy5kb25lKCk7CiAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjg7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDk6CiAgICAgICAgICBjb25zb2xlLmxvZyhzdG9yZS5nZXR0ZXJzLm5hbWUpOwogICAgICAgICAgaGFzR2V0VXNlckluZm8gPSBzdG9yZS5nZXR0ZXJzLm5hbWU7CiAgICAgICAgICBpZiAoIWhhc0dldFVzZXJJbmZvKSB7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxNTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgICBuZXh0KCk7CiAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjg7CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDE1OgogICAgICAgICAgX2NvbnRleHQucHJldiA9IDE1OwogICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE4OwogICAgICAgICAgcmV0dXJuIHN0b3JlLmRpc3BhdGNoKCd1c2VyL2dldEluZm8nKTsKICAgICAgICBjYXNlIDE4OgogICAgICAgICAgbmV4dCgpOwogICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI4OwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAyMToKICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAyMTsKICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbImNhdGNoIl0oMTUpOwogICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI1OwogICAgICAgICAgcmV0dXJuIHN0b3JlLmRpc3BhdGNoKCd1c2VyL3Jlc2V0VG9rZW4nKTsKICAgICAgICBjYXNlIDI1OgogICAgICAgICAgTWVzc2FnZS5lcnJvcihfY29udGV4dC50MCB8fCAnSGFzIEVycm9yJyk7CiAgICAgICAgICBuZXh0KCIvbG9naW4/cmVkaXJlY3Q9Ii5jb25jYXQodG8ucGF0aCkpOwogICAgICAgICAgTlByb2dyZXNzLmRvbmUoKTsKICAgICAgICBjYXNlIDI4OgogICAgICAgICAgX2NvbnRleHQubmV4dCA9IDMxOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAzMDoKICAgICAgICAgIC8qIGhhcyBubyB0b2tlbiovCgogICAgICAgICAgaWYgKHdoaXRlTGlzdC5pbmRleE9mKHRvLnBhdGgpICE9PSAtMSkgewogICAgICAgICAgICAvLyBpbiB0aGUgZnJlZSBsb2dpbiB3aGl0ZWxpc3QsIGdvIGRpcmVjdGx5CiAgICAgICAgICAgIG5leHQoKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIG90aGVyIHBhZ2VzIHRoYXQgZG8gbm90IGhhdmUgcGVybWlzc2lvbiB0byBhY2Nlc3MgYXJlIHJlZGlyZWN0ZWQgdG8gdGhlIGxvZ2luIHBhZ2UuCiAgICAgICAgICAgIG5leHQoIi9sb2dpbj9yZWRpcmVjdD0iLmNvbmNhdCh0by5wYXRoKSk7CiAgICAgICAgICAgIE5Qcm9ncmVzcy5kb25lKCk7CiAgICAgICAgICB9CiAgICAgICAgY2FzZSAzMToKICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgfQogICAgfSwgX2NhbGxlZSwgbnVsbCwgW1sxNSwgMjFdXSk7CiAgfSkpOwogIHJldHVybiBmdW5jdGlvbiAoX3gsIF94MiwgX3gzKSB7CiAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH07Cn0oKSk7CnJvdXRlci5hZnRlckVhY2goZnVuY3Rpb24gKCkgewogIC8vIGZpbmlzaCBwcm9ncmVzcyBiYXIKICBOUHJvZ3Jlc3MuZG9uZSgpOwp9KTs="},{"version":3,"names":["router","store","Message","NProgress","getToken","getPageTitle","configure","showSpinner","whiteList","beforeEach","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","to","from","next","hasToken","hasGetUserInfo","wrap","_callee$","_context","prev","start","document","title","meta","path","done","console","log","getters","name","dispatch","t0","error","concat","indexOf","stop","_x","_x2","_x3","apply","arguments","afterEach"],"sources":["/Users/mac/code/2023/vue0508_副本/src/permission.js"],"sourcesContent":["import router from './router'\nimport store from './store'\nimport { Message } from 'element-ui'\nimport NProgress from 'nprogress' // progress bar\nimport 'nprogress/nprogress.css' // progress bar style\nimport { getToken } from '@/utils/auth' // get token from cookie\nimport getPageTitle from '@/utils/get-page-title'\n\nNProgress.configure({ showSpinner: false }) // NProgress Configuration\n\nconst whiteList = ['/login'] // no redirect whitelist\n\nrouter.beforeEach(async (to, from, next) => {\n  // start progress bar\n  NProgress.start()\n\n  // set page title\n  document.title = getPageTitle(to.meta.title)\n\n  // determine whether the user has logged in\n  const hasToken = getToken()\n\n  if (hasToken) {\n    if (to.path === '/login') {\n      // if is logged in, redirect to the home page\n      next({ path: '/' })\n      NProgress.done()\n    } else {\n      console.log(store.getters.name);\n      const hasGetUserInfo = store.getters.name\n      if (hasGetUserInfo) {\n        next()\n      } else {\n        try {\n          // get user info\n          await store.dispatch('user/getInfo')\n          next()\n        } catch (error) {\n          // remove token and go to login page to re-login\n          await store.dispatch('user/resetToken')\n          Message.error(error || 'Has Error')\n          next(`/login?redirect=${to.path}`)\n          NProgress.done()\n        }\n      }\n    }\n  } else {\n    /* has no token*/\n\n    if (whiteList.indexOf(to.path) !== -1) {\n      // in the free login whitelist, go directly\n      next()\n    } else {\n      // other pages that do not have permission to access are redirected to the login page.\n      next(`/login?redirect=${to.path}`)\n      NProgress.done()\n    }\n  }\n})\n\nrouter.afterEach(() => {\n  // finish progress bar\n  NProgress.done()\n})\n"],"mappings":";;;AAAA,OAAOA,MAAM,MAAM,UAAU;AAC7B,OAAOC,KAAK,MAAM,SAAS;AAC3B,SAASC,OAAO,QAAQ,YAAY;AACpC,OAAOC,SAAS,MAAM,WAAW,EAAC;AAClC,OAAO,yBAAyB,EAAC;AACjC,SAASC,QAAQ,QAAQ,cAAc,EAAC;AACxC,OAAOC,YAAY,MAAM,wBAAwB;AAEjDF,SAAS,CAACG,SAAS,CAAC;EAAEC,WAAW,EAAE;AAAM,CAAC,CAAC,EAAC;;AAE5C,IAAMC,SAAS,GAAG,CAAC,QAAQ,CAAC,EAAC;;AAE7BR,MAAM,CAACS,UAAU;EAAA,IAAAC,IAAA,GAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,CAAC,SAAAC,QAAOC,EAAE,EAAEC,IAAI,EAAEC,IAAI;IAAA,IAAAC,QAAA,EAAAC,cAAA;IAAA,OAAAP,mBAAA,GAAAQ,IAAA,UAAAC,SAAAC,QAAA;MAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAL,IAAA;QAAA;UACrC;UACAd,SAAS,CAACqB,KAAK,EAAE;;UAEjB;UACAC,QAAQ,CAACC,KAAK,GAAGrB,YAAY,CAACU,EAAE,CAACY,IAAI,CAACD,KAAK,CAAC;;UAE5C;UACMR,QAAQ,GAAGd,QAAQ,EAAE;UAAA,KAEvBc,QAAQ;YAAAI,QAAA,CAAAL,IAAA;YAAA;UAAA;UAAA,MACNF,EAAE,CAACa,IAAI,KAAK,QAAQ;YAAAN,QAAA,CAAAL,IAAA;YAAA;UAAA;UACtB;UACAA,IAAI,CAAC;YAAEW,IAAI,EAAE;UAAI,CAAC,CAAC;UACnBzB,SAAS,CAAC0B,IAAI,EAAE;UAAAP,QAAA,CAAAL,IAAA;UAAA;QAAA;UAEhBa,OAAO,CAACC,GAAG,CAAC9B,KAAK,CAAC+B,OAAO,CAACC,IAAI,CAAC;UACzBd,cAAc,GAAGlB,KAAK,CAAC+B,OAAO,CAACC,IAAI;UAAA,KACrCd,cAAc;YAAAG,QAAA,CAAAL,IAAA;YAAA;UAAA;UAChBA,IAAI,EAAE;UAAAK,QAAA,CAAAL,IAAA;UAAA;QAAA;UAAAK,QAAA,CAAAC,IAAA;UAAAD,QAAA,CAAAL,IAAA;UAAA,OAIEhB,KAAK,CAACiC,QAAQ,CAAC,cAAc,CAAC;QAAA;UACpCjB,IAAI,EAAE;UAAAK,QAAA,CAAAL,IAAA;UAAA;QAAA;UAAAK,QAAA,CAAAC,IAAA;UAAAD,QAAA,CAAAa,EAAA,GAAAb,QAAA;UAAAA,QAAA,CAAAL,IAAA;UAAA,OAGAhB,KAAK,CAACiC,QAAQ,CAAC,iBAAiB,CAAC;QAAA;UACvChC,OAAO,CAACkC,KAAK,CAACd,QAAA,CAAAa,EAAA,IAAS,WAAW,CAAC;UACnClB,IAAI,oBAAAoB,MAAA,CAAoBtB,EAAE,CAACa,IAAI,EAAG;UAClCzB,SAAS,CAAC0B,IAAI,EAAE;QAAA;UAAAP,QAAA,CAAAL,IAAA;UAAA;QAAA;UAKtB;;UAEA,IAAIT,SAAS,CAAC8B,OAAO,CAACvB,EAAE,CAACa,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE;YACrC;YACAX,IAAI,EAAE;UACR,CAAC,MAAM;YACL;YACAA,IAAI,oBAAAoB,MAAA,CAAoBtB,EAAE,CAACa,IAAI,EAAG;YAClCzB,SAAS,CAAC0B,IAAI,EAAE;UAClB;QAAC;QAAA;UAAA,OAAAP,QAAA,CAAAiB,IAAA;MAAA;IAAA,GAAAzB,OAAA;EAAA,CAEJ;EAAA,iBAAA0B,EAAA,EAAAC,GAAA,EAAAC,GAAA;IAAA,OAAAhC,IAAA,CAAAiC,KAAA,OAAAC,SAAA;EAAA;AAAA,IAAC;AAEF5C,MAAM,CAAC6C,SAAS,CAAC,YAAM;EACrB;EACA1C,SAAS,CAAC0B,IAAI,EAAE;AAClB,CAAC,CAAC"}]}